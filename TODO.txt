TODO 24/09:
-Check input corretto																									X
	-se qualche input manca, metto un generico human genome ref, 0 0 0, 2 guide (quelle nel placeholder), NGG pam		X
	-se le guide sono errate (lunghezze diverse, + di mille), tengo valida la prima e scarto quelle non conformi		X
-Controllare se add-variants mi crea una cartella all'interno di SNP genomes, nel caso fare in modo che lo faccia		X
-PAM sinistra/destra																									X
	-in base alla pam scelta sul server, sistemo la cosa																X
-Da symlink a cp																										X
-Collegare annotazioni con i genomi esatti		X
-Sulla pagina load, fare il controllo subito così l'utente non aspetta i 3 secondi
-Implementare opzione aggiuntiva -gecko																					X
-Implementare opzione aggiuntiva barplot																				X <- check bug generate report
-Aggiungere pam corrette
	-5'-NGG-3'			X
	-Poi sistemare nella chiamata che deve essere uguale al file														X
-Sistemare menu			X
-Sistemare email		X
-Sistemare genomi, avere solo un elenco
-Non far partire l'indice e l'arricchimento, saranno già presenti sul server											X
-Aggiungere controllo guide per vedere se i res sono già stati fatti													X
-Bug nel generate report, se provo a fare barplot di un mms che ha 0 risultati mi da errore
(Traceback (most recent call last):
  File "/home/edirupo/.conda/envs/webapp/opt/crispritz/Python_Scripts/Plot/radar_chart.py", line 134, in <module>
    arraySummaryCountTwo[:, uppermm])/10), math.ceil(max(arraySummaryCountTwo[:, uppermm])/5))
ValueError: arange: cannot compute length
)
	-se y_range = 0 0 0, significa che non ci sono target con quei mms in ref e in enr, quindi creo plot con scritto no
	no result. Posso usare max tra y_range e 10 per evitare errore
	-testarlo se almeno enr o ref ha 1+ risultati, si, se entrambi sono 0 mi da errore									X
-Controllo se i risultati sono 0, inviare messaggio di errore/risultati 0												X
	-migliorare grafica dei risultati a 0 e risultati che non esistono più
	
26/09
-Sistemare barplot		X		(vedere radar_chart.py)
-Inserire Error nel load se non esiste il risultato			X
-Sul load, fare controllo subito per non aspettare 3 sec  -> forse non possibile
-Modificare stile warnings			X -> da vedere se va bene
-Modificare stile menu						X
	-Sistemare grandezza hover sui home, about,contacts		X -> va bene così
-Inserite title per spigazioni opzioni avanzate				X
	-Modificare allineamento checkbox						X
-Inserire spiegazione guide									X
-Inserire 'send us email or download offline'				X
	-Inserire link a contatti e download
-Modificare stile barplot quando non ho risultati			X
-Modificare la mail											X
	-Aggiungere paramtri alla mail
-Aggiungere tutte le pam									X
-Collegare annotazioni con genomi esatti					X
-Aumentare dimensioni checklist

-Creare docker con tutto

27/09
-Indice genomi con 25 e con 20 (lunghezza pam) mi da stessi risultati ma posizioni diverse di 5 nei res dei 20, controllo le posizioni coi res di cas offinder (secondo genoma)



docker build -t my_docker .
docker run -it my_docker [COMMAND]
docker run -p 8080:80 my_docker python3 app_simplified_bootstrap.py

30/09
-Inserire nota sotto select genome per specificare il vcf
	-Note: genomes with a + means variants
-Cambiare il contact us in due frasi allineate con 'contact us for genome availability' e 'If you want custom genome, vcf, mms bulges etc etc download offline version (con link)' X
-Togliere upload e mettere limite a 1000 guide			X
-Mettere la spiegazione delle adv opts come: Compare your results with gecko library e Compare your result with ref genome		X
-Inserire un avviso se input manca		X 
	- Inserire elenco input mancanti	X
-Testare docker e fare file per scaricare e sistemare i genomi
-Cambiare icona

-Pe crispritz: quando trovo un target che ha + di una variante, se sono varianti di persone diverse la scarto.
Alla fine per ogni targets trovato devo avere un elenco dei sample da dove sono arrivati e fare un istogramma dove indico, per ogni gruppo di sampl (1s, 2s, 3s) il numero di target trovati:
eg.  ci sono 1000 target che hanno 3 samples

-Quando faccio enrich genome, mi tengo i file .alt creati, o li modifico in modo da avere anche la lista di sample da dove arrivano
-Dopoche ho ottenuto i targets dalla ricerca, per ogni target controllo:
	-Se non ha iupac, non faccio nulla
	-Se ha 1 iupac, controllo sul file .alt, in base alla posizione (position + posizione dello iupac), a che sample appartengono e lo aggiungo ai vari sample1.txt, sample2.txt ... file
	-Se ha 1+ iupac, controllo il primo iupac a che sample appartengono (come sopra), poi faccio la stessa cosa col 2 iupac e così via. Faccio l'intersezione tra i vari gruppi
	di sample trovati e se il risultato non è vuoto, aggiungo quel sample nei sample.txt rimasti nell'intersezione.




---01/10
-Inserire una guida gìà come esempio
-Mettere 7 mms come massimo		X
-Inserire possibilità di mettere sequenze come crispor (con varianti!), oppure posizizioni sul genoma. Da questa sequenza estraggo la pam selezionata
e ottengo delle guide che poi vado a cercare su genoma enr.			
	-Aggiungere PAM inizio
	-Inserire controllo sugli input mancanti anche ai textbox e dropdown sulle sequenze			X
	-Inserire controllo correttezza input textbox e dropdown sequenze							X
-Senza cliccare su view vai direttamente alla pagina
-Result con 2 'pagine'
	-Ho il profiling completo: per ogni soglia di mms metto la somma dei profiling su tutte le guide in quella colonna <- non mi da molte info, non lo faccio
	-Una in cui seleziono la guida e ho il profiling di quella guida e le immagini
		-Mi copio la tabella del profiling sul sito			X
	-Vedere come funziona doench e cfd e mettere cfd e doench su on targets, solo cfd su off targets. (vedere crispor)
	-Se clicco su più info, compare la tabella completa di tutti gli offtargets (per quella guida), ordinate in base a (mm+bulge più basso),
	(priorità a offtargets sul gen enriched), (cfd e doench più alti -> cut efficiency più alta). Colorare con colori diversi gli offt se vengono da gen enr o ref
	-Per colorare, se un target ha una variante allora è del gen enr, se non le ha allora del gen ref --> controllare se i ref possono avere iupac
		-PROBLEMA: se nei targets ho uno IUPAC, 'perdo' l'informazione riguardo che lettera c'era in quel posto nel ref -> vedere se avere l'info del ref
		è importante (allora dobbiamo distinguere -> fare due ricerche su enr e ref) oppure no (fare singola ricerca e dividere in base a presenza iupac)
-Inserire link per scaricare tutti gli offt, lasciar gestire ad apache il tutto
-Inserire un riassunto dei parametri della ricerca
-CFD score in notazione scientifica

-Fare un group by per ogni posizione e vedere se i ref e il var è sempre lo stesso o cambia (potrei avere 2500 A G e il resto A T)
-Generare index genome NNN e 2 bulges su MV 

-Fare script per tagliare sequenze		X
-Fare in modo che clicco sulla guida e gli offt appaiono su una nuova scheda	X
-Doench solo per ont
-Colonna cfd per max e min value per quella guida, stessa cosa per doenc


-10/08
load example con impostazioni stardard 

area score  0-1 
cfd total
guide details

list of alll targets

-Ordinare le guide nella result page da meglio a peggio, mettere CFD globale e area score, mettere come crispor i mmismatches e area score per ogni mm value
Se clicco sulla guida, viene selezionata e sotto appare una tabella a 2 colonne con le immagini a sx il radarchart a dx il barplot (fare per ogni guida)
	-I file count sono così strutturati:				X fatto barplot per guida
		-GUIDA	num_targets_inExons_0mms	num_targets_inExons_1mms	num_targets_inExons_2mms ...
-differenziare target per ref o enr (2 ricerche intanto)
Seguire immagine di Luca per tabella targets
-Far vedere che guida è stata selezionata
-Bottone per esempio da far runnare			X
-Modificare bottone farlo bello

11-10
-Mettere bottone Insert/Delete vicino a step1
-Mettere bottone per avere le immagini con 1 mm, 2 mm, ...mms, e show all
-Mettere sotto focus on il link per vedere tutti i target di quella guida
-Filtering e ordinamento nella tabella delle guide
-Fare immagini più piccole e meglio sistemate

-Idea per estrarre only_enr: nella creazione dei res faccio un hash su guida+chr+pos e poi quando controllo nel enr vedo se il suo hash compare nella tabella già compilata e lo scarto
-Vedere java hash

-Scaricare bedfile, estrarre seq e creare cartelle per ogni bedfile. indicizzare, fare ricerca con le due guide 6 mm 2 2 

-Per velocizzare l'estrazione dei dati (comm, uniq, min_max), possiamo cambiare il nome dei chr quando creiamo il file dei targets cambiano carattteri come _ in - in modo
da poter usare LC_ALL=C


TODO per giovedì 24 (non tutto, il più possibile)
Pagina principale:
- Testare come inserire javascript in dash, per esempio cliccare una parola e far modificare il contenuto di un altro elemento della pagina
	-Serve per esempio per inserire/cancellare gli input di esempio nella pagina principale
-Altrimenti modificare lo stile del bottone di insert example per farlo somigliare ad un link
-Inserire un altro bottone simile a quello di prima per cancellare l'esempio inserito, oppure usare lo stesso bottone
	-Vedere se possibile implementare 3 idee:
		-Cancellare tutti i valori inseriti
		-Cancellare solo i valori che sono uguali a quelli di esempio e non quelli che sono stati modificati dall'utente
		-Se anche un solo valore è diverso da quello di esempio, non cancellare niente

Pagina dei risultati con la tabella delle guide:
-Aggiungere possibilità di filtering e sorting della tabella (controllare https://dash.plot.ly/datatable e https://dash.plot.ly/datatable/callbacks)
-Modificare le colonne tenendo solo CFD, On-Targets, Off-targets, Off-targets for 0-1-2-3-4...mms (in base ai mmismatches di quella ricerca).
-Nella cella Off-targets for 0-1-2... mettere il numero di offtargets trovati per quel valore di mms, per esempio 1-12-15-50. I valori si trovano
nel file profiling, o profiling complete se presente, ed è caricato in un dataframe quando la tabella è visualizzata, quindi si può partire da li
per costruire la stringa da far vedere nella cella.
-Testare se mettere un buttongroup è più bello rispetto ai bottoni attuali
-Continuare l'implementazione per i bottoni (funzione loadColumnImages()), mettendo come input tutti i bottoni, e verificando qual è l'ultimo 
bottone cliccato e visualizzando le immagini con quel valore di mms. 

Pagina del load job
-Quando tutti i passaggi di crispritz sono completati, compare un link per andare nella pagina results. Sarebbe meglio che ci fosse un
reindirizzamento automatico. Quindi modificare la chiamata dell'interval per fare in modo che quando tutti e tre i processi sono completati
si venga reindirizzati. Idea: modificare un div nascosto per segnalare che la ricerca è finita e quando il div viene modificato 
far partire la chiamata per il change url --> potrebbe richiedere modifiche per la funzione changePage()




-Finire immagini e tabella per la ricerca fatta 2 settimane fa, per far vedere che visualizzare tutti i risultati non è fattibile
-Copiare i risultati di casoffinder -> creo tabella con ogni combinazione mm-bulge-guida e calcolo il numero di target trovati in quella categoria
	-questa tabella è visualizzata dove ci sono le immagini, creo un altro bottone con label 'Summary Table'
	-Se clicco la riga corrispondente mi apre la pagina dei targets (come quella attuale) ma visualizzo solo i target in quel range (uso grep per prendere i target e li salvo su file temporaneo)



-Sistemare il grep delle sequenze da vedere sulla pagina della guida specifica: al momento il txt estratto è nella cartella principale, deve essere spostato
nella cartella del job corrispondente



-Creare colonna con num only var e num colonna blu nella tabella del summary guide-threshold	X
-Bloccare/nascondere colonne dei targets 		X
-modificare posiizone dei target con bulges per ricondurre la pos alla versiobne senza bulges

-Cancellare coppie mms-bulges che hanno 0 Targets			X
-cambaire colore hover icone ordinamento/nascondi colonna
-Mettere bottone show all columns

-Mettere avviso che se l'utente cerca con variant, popup per dire che se vuole può fare comparison con genoma riferimento
-Colonne dinamiche in base a che tipo di ricerca è stata fatta (solo ref/solo var, var + comparazione ref (ovvero le colonne del post processing))


-14/11
-Tutta la riga della guida evidenziata (tabella generale guida)
-Font e grandezza
-Tabella guida specifica -> aggiungo colonna more info e metto i link li, li tolgo dalla guida		X
-Ordino tabella guida specifica per bulge+mms e num massimo var uniq								X
	-Sistemare allineamento celle
-Pam creation evidenziare ancora di più -> se un target ha la colonna pam creation, lo evidenzio con un altro colore
-Colore dei target su tutta la riga (più trasparente possibile), oppure allargare la banda colorate, migliorare il nome colonne, resize delle colonne
-Help e legenda per spiegare colori e colonne
-Tenere solo NO e elenco di tutte le PAM, non -;A-;
-Mostrare solo top 1 del cluser, se lo clicco si apre tutto il cluster -> Idea Fare due tabelle: se clicco sul top one, sulla secodna tabella si apre il suo cluster
-Samples: fare solo top 1, combinazione di tutti gli iupac , che se clicco si apre la riga sotto con tutte le possibili combinazioni (che hanno samples) --> Aggiungere colonna sulle guide
 con individual smaples e metto la somma dei targets trovati su tutti i targets (calcolo fatto solo sui top 1)
-Aggiungere colonna doench (tenere migliore)
-Tabella guide generale ordinabile e max 100 guide per pagina

-Tabella dei target dei samples: contiene solo top1 e on targets, se clicco su target viene scomposta. La scomposizione contiene solo i targets che hanno almeno 1 var e appartengono a quel sample
-La scomposizione delle guide la faccio sui cluster: se seleziono un target si apre il cluster di quel target mostrando solo i targets con quel valore di mm-bulge (apro un sottocluster)

-Implementare bottone next e prev nella tabella popolazione
